# Extension

PHPLint defines a standard set of capabilities which may be implemented by extensions.

Each extension is based on [Event Driven Architecture](./event.md), 
and must implement the `Overtrue\PHPLint\Extension\ExtensionInterface` interface

## Naming extension

Each extension should have a unique name to be easily identified. This identifier may be retrieved with
`getName()` of `ExtensionInterface` contract.

## Command Provider

The `getCommands()` capability allows to register additional commands for PHPLint.

```php
<?php
use Overtrue\PHPLint\Extension\ExtensionInterface;
use Symfony\Component\Console\Attribute\AsCommand;
use Symfony\Component\Console\Command\Command;

class MyExtension implements ExtensionInterface
{
    public function getName(): string
    {
        return 'my-extension';
    }
    
    public static function getCommands(): array
    {
        return [
            new MyCommand(),
        ];
    }
}

#[AsCommand(name: 'custom-extension-command', description: 'Extension demo with commands capabilities')]
class MyCommand extends Command
{
    protected function execute(InputInterface $input, OutputInterface $output): int
    {
        $output->writeln('Processing ' . __CLASS__);
        return self::SUCCESS;
    }
}
```

Once defined, you have to register the new extension into the PHPLint application.

```php
#!/usr/bin/env php
<?php

require_once 'autoload.php';

use Overtrue\PHPLint\Command\LintCommand;
use Overtrue\PHPLint\Console\Application;

$defaultCommand = new LintCommand();

$extensions = [
    new MyExtension(),
];

$application = new Application();
$application->add($defaultCommand);
$application->setDefaultCommand($defaultCommand->getName());
$application->addExtensions($extensions);
$application->run($input);
```

Now the `custom-extension-command` is available alongside PHPLint commands.

## Command Inputs Provider

The `getDefinition()` capability allows to register additional arguments and options for PHPLint.

```php
<?php
use Overtrue\PHPLint\Extension\ExtensionInterface;
use Symfony\Component\Console\Attribute\AsCommand;
use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputDefinition;
use Symfony\Component\Console\Input\InputOption;

class MyExtension implements ExtensionInterface
{
    public function getName(): string
    {
        return 'my-extension';
    }
    
    public static function getCommands(): array
    {
        return [
            new MyCommand(),
        ];
    }
    
    public static function getDefinition(): InputDefinition
    {
        return new InputDefinition(
            [
                new InputOption(
                    'extra-option',
                    null,
                    InputOption::VALUE_NONE,
                    'Additional option for the lint command'
                ),
			]
		);		
    }
}
```

## UML Diagram

![UML Diagram](../assets/extension-uml-diagram.svg)

Generated by [bartlett/graph-uml][bartlett/graph-uml] package via the `resources/graph-uml/build.php` script.

[bartlett/graph-uml]: https://packagist.org/packages/bartlett/graph-uml
